<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>iOS公告发送端</title>
  <style>
    * { margin: 10px; padding: 5px; box-sizing: border-box; }
    input, textarea { width: 90%; font-size: 16px; }
    button { width: 90%; padding: 15px; background: #2563eb; color: white; border: none; border-radius: 8px; font-size: 16px; }
  </style>
</head>
<body>
  <h3>iOS公告发送</h3>
  <input id="noticeTitle" placeholder="请填公告标题" />
  <textarea id="noticeContent" placeholder="请填公告内容（换行也可以）" rows="5"></textarea>
  <button onclick="sendToServer()">发送到iOS设备</button>

  <script>
    // 替换成你的Render项目公网地址（后续部署后填）
    const RENDER_URL = 'wss://prj-d3gul5b3fgac739beq00.onrender.com';
    // 替换成上面server.js里的SENDER_TOKEN（比如“ios-notice-123”）
    const SENDER_TOKEN = 'your-ios-token';

    // 连接服务器
    let ws = new WebSocket(`${RENDER_URL}?token=${SENDER_TOKEN}`);
    ws.onopen = () => console.log('已连接服务器，可发送公告');
    ws.onerror = (err) => alert('连接失败，检查地址和token是否正确');

    // 发送公告
    function sendToServer() {
      const title = document.getElementById('noticeTitle').value.trim();
      const content = document.getElementById('noticeContent').value.trim();
      if (!title || !content) {
        alert('标题和内容不能为空！');
        return;
      }
      // 发送给服务器
      ws.send(JSON.stringify({ title, content }));
      alert('发送成功！iOS设备1秒内会弹通知');
      // 清空输入
      document.getElementById('noticeTitle').value = '';
      document.getElementById('noticeContent').value = '';
    }
  </script>
</body>
</html>
